(function(t){function e(e){for(var o,a,l=e[0],r=e[1],c=e[2],d=0,f=[];d<l.length;d++)a=l[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);u&&u(e);while(f.length)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,l=1;l<n.length;l++){var r=n[l];0!==i[r]&&(o=!1)}o&&(s.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={app:0},s=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=r;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),i=n.n(o);i.a},"0368":function(t,e,n){},"0e96":function(t,e,n){"use strict";var o=n("c492"),i=n.n(o);i.a},"2d23":function(t,e,n){},"2d4a":function(t,e,n){"use strict";n.r(e),n.d(e,"menuLiffID",(function(){return o})),n.d(e,"menuLiffUrl",(function(){return i})),n.d(e,"createPollLiffID",(function(){return s})),n.d(e,"pollLiffID",(function(){return a})),n.d(e,"pollLiffUrl",(function(){return l}));var o="1654140168-7nLX4NLY",i="https://liff.line.me/"+o,s="1653977512-nmgd89ge",a="1653977512-XJQLkOQW",l="https://liff.line.me/"+a},"2d94":function(t,e,n){},"3ed5":function(t,e,n){"use strict";var o=n("0368"),i=n.n(o);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],a={},l=a,r=(n("034f"),n("2877")),c=Object(r["a"])(l,i,s,!1,null,null,null),u=c.exports,d=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[t._v(t._s(t.greetingText))]),t._l(t.names,(function(e){return n("h1",{key:e,staticClass:"title"},[t._v(t._s(e))])})),n("b-field",[n("b-input",{attrs:{placeholder:t.placeholder},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t.name?n("b-button",{attrs:{type:"is-primary"},on:{click:t.enter}},[t._v("Enter")]):n("b-button",{attrs:{type:"is-primary"}},[t._v("Waiting your name...")]),t.name?n("b-button",{attrs:{type:"is-secondary"},on:{click:t.add}},[t._v("Add name")]):t._e()],2)])},p=[],h=(n("b0c0"),{data:function(){return{placeholder:"Tell us your name",name:null,greetingText:"Hello! What's your name?",names:[]}},methods:{enter:function(){this.name&&(this.greetingText="Hello, "+this.name+"!",this.name=null)},add:function(){this.name&&(this.names.push(this.name),this.name=null)}},watch:{name:function(){this.name&&(this.greetingText="Hello, "+this.name+"!")}}}),v=h,g=Object(r["a"])(v,f,p,!1,null,null,null),m=g.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[t._v("Pizzanulok menu")]),t.userProfile?n("h3",{staticClass:"subtitle"},[t._v("สวัสดีคุณ "+t._s(t.userProfile.displayName)+" ทานอะไรดีคะ 😀")]):n("h3",{staticClass:"subtitle"},[t._v("สวัสดีค่ะ ทานอะไรดีคะ 😀")]),n("div",{staticClass:"columns is-multiline"},[n("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),t._l(t.pizzas,(function(e){return n("div",{key:e.id,staticClass:"column is-half"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-image"},[n("figure",{staticClass:"image is-4by3"},[n("img",{attrs:{src:""+e.url,alt:""+e.name}})])]),n("div",{staticClass:"card-content"},[n("div",{staticClass:"content"},[n("p",{staticClass:"title is-2"},[t._v(t._s(e.name))]),n("p",{staticClass:"subtitle"},[t._v("฿ "+t._s(e.price))]),n("p",{staticClass:"subtitle is-6"},[t._v("ส่วนประกอบ: "+t._s(e.ingredients.toString()))])]),n("b-button",{attrs:{type:"is-primary is-fullwidth"},on:{click:function(n){return t.order(e)}}},[t._v("สั่งเลย")])],1)])])})),t.userProfile&&!t.isLoading?n("div",{staticClass:"share"},[n("p",{staticClass:"subtitle"},[t._v("หรือถ้าคิดไม่ออก ลองส่งเมนูไปให้เพื่อนช่วยเลือกมั้ย 🤓")]),n("button",{staticClass:"button",on:{click:t.share}},[t._v("แชร์เมนู")])]):t._e()],2)])])},y=[],_=(n("d81d"),n("5530")),C=n("dc59"),I=n("2d4a"),x={data:function(){return{pizzas:[{name:"Hawaiian",price:300,url:"https://storage.googleapis.com/devfest-181020.appspot.com/pizzas/hawaiian.jpg",ingredients:["Ham","Pineapple","Bacon"]}],isLoading:!1,userProfile:null}},mounted:function(){var t=this,e=this.$liff;e.init({liffId:"1654140168-7nLX4NLY"}).then((function(){console.log("LIFF initialize finished"),e.isLoggedIn()?e.getProfile().then((function(e){t.userProfile=e})).catch((function(t){console.error(t)})):(console.log("LIFF is not logged in"),e.login())})).catch((function(t){console.error("Error initialize LIFF: ",t)})),this.isLoading=!0,C.pizzasCollection.get().then((function(e){t.pizzas=e.docs.map((function(t){return Object(_["a"])({id:t.id},t.data())})),t.isLoading=!1}))},methods:{order:function(t){console.log(t.name);var e=this.$liff,n=e.getContext();n&&"none"!==n.type&&e.sendMessages([{type:"text",text:"สั่ง ".concat(t.name)}]).then((function(){console.log("Message sent"),e.closeWindow()})).catch((function(t){console.log("Error sending message: "+t)}))},share:function(){console.log("share menu");var t=this.$liff;t.shareTargetPicker([{type:"text",text:"ช่วยดูเมนูพิซซ่าหน่อย กินไรดี "+I.menuLiffUrl}]).then((function(){console.log("Message sent")})).catch((function(t){console.log("Error sending message: "+t)}))}}},z=x,L=(n("c710"),Object(r["a"])(z,b,y,!1,null,"dd71664e",null)),w=L.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[t._v("Create Pizzanulok Poll")]),n("b-field",{attrs:{label:"Name"}},[n("b-input",{attrs:{placeholder:"Poll name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),n("div",{staticClass:"buttons is-centered"},[n("b-button",{on:{click:t.cancel}},[t._v("Cancel")]),n("b-button",{class:{"is-loading":t.isCreating},attrs:{type:"is-primary"},on:{click:t.start}},[t._v("Start")])],1)],1)])},k=[],P=n("dc59"),$=n("2d4a"),V={data:function(){return{name:null,isCreating:!1,userProfile:null}},beforeMount:function(){var t=this,e=t.$liff;e.init({liffId:$.createPollLiffID}).then((function(){return console.log("LIFF initialized"),e.isLoggedIn()?e.getProfile().then((function(e){delete e.statusMessage,console.log(JSON.stringify(e)),t.userProfile=e})):e.login()})).catch((function(t){console.error(t)}))},methods:{cancel:function(){this.$buefy.notification.open("Clicked!!"),this.$liff.closeWindow()},start:function(){var t=this;t.name?(t.isCreating=!0,P.pizzasCollection.get().then((function(e){var n=e.docs.map((function(t,e){var n=t.data();return{value:e,text:n.name,votes:0}}));P.pollsCollection.add({name:t.name,options:n,createdBy:t.userProfile}).then((function(e){if(console.log(e),t.isCreating=!1,t.toast("โพลถูกสร้างแล้ว!",!0),t.$liff.isLoggedIn()){var n=[{type:"text",text:"โพล ".concat(t.name," ของคุณถูกสร้างแล้ว ส่งต่อให้เพื่อนได้เลย")},{type:"text",text:$.pollLiffUrl+"?poll="+e.id}];t.$liff.sendMessages(n).then((function(){console.log("message sent"),t.$liff.closeWindow()})).catch((function(t){console.log("error",t)}))}})).catch((function(e){t.isCreating=!1,t.toast("อุ๊ย! มีบางอย่างผิดพลาด",!1),console.error(e)}))}))):t.toast("กรุณาตั้งชื่อโพล",!1)},toast:function(t,e){this.$buefy.toast.open({message:t,position:"is-bottom",type:e?"is-success":"is-danger"})}}},j=V,S=Object(r["a"])(j,O,k,!1,null,null,null),E=S.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),t.poll?n("h1",{staticClass:"title"},[t._v(t._s(t.poll.name))]):t._e(),t.isVoted?n("div",t._l(t.options,(function(e){return n("button",{key:e.value,class:t.selectedOption===e.value?"button is-fullwidth vote-option is-primary":"button is-fullwidth is-outlined vote-option",on:{click:function(n){return t.showVoters(e)}}},[t._v(t._s(e.text)+" ("+t._s(e.votes)+")")])})),0):n("div",t._l(t.options,(function(e){return n("button",{key:e.value,staticClass:"button is-fullwidth vote-option",on:{click:function(n){return t.addVote(e)}}},[t._v(t._s(e.text))])})),0),t.poll?n("p",{staticClass:"is-size-7"},[t._v("created by "+t._s(t.createdBy))]):t._e()],1)])},N=[],M=(n("4de4"),n("c740"),n("ee68")),U=n.n(M),A=n("dc59"),T=n("2d4a"),D={data:function(){return{pollId:this.$route.params.id,poll:null,options:[],isVoted:!1,isLoading:!1,selectedOption:0,createdBy:"unknown",user:{userId:"Uec2c48270f939fb48fc5b1e9e9f8e016",displayName:"Nui (นุ้ย)",pictureUrl:"https://profile.line-scdn.net/0h-A8HUAf0cm4FMVpSchENOTl0fANyH3QmfVVqDyE1JAp7A2c4OFRvCidmKF4pCTw7Ol8_WiJkK1wg"}}},beforeCreate:function(){var t=this,e=t.$liff;e.init({liffId:T.pollLiffID}).then((function(){if(console.log("LIFF initialized"),"web"===e.getOS()&&!e.isLoggedIn()){var n=window.location.origin+t.$router.currentRoute.fullPath;e.login({redirectUri:n})}e.getProfile().then((function(e){t.user=e}))})).catch((function(t){console.error(t)}))},mounted:function(){var t=this;this.isLoading=!0,A.pollsCollection.doc(this.pollId).onSnapshot((function(e){console.log("Received doc snapshot: ".concat(JSON.stringify(e.data()))),t.isLoading=!1;var n=e.data();t.poll=n,t.options=n.options,t.createdBy=n.createdBy.displayName;var o=Array.isArray(n.voters)?n.voters.filter((function(e){return e.userId===t.user.userId}))[0]:{};o&&o.option&&(t.isVoted=!0,t.selectedOption=o.option)}),(function(e){console.log("Encountered error: ".concat(e)),t.isLoading=!1}))},methods:{addVote:function(t){var e=this;console.log("You voted "+t.text+"!"),this.selectedOption=t.value;var n=this.options.findIndex((function(t){return t.value===e.selectedOption}));if(n>=0){this.options[n].votes+=1;var o=this.user;o.option=this.selectedOption,A.pollsCollection.doc(this.pollId).update({options:this.options,voters:U.a.firestore.FieldValue.arrayUnion(o)}),this.isVoted=!0}},showVoters:function(t){console.log(t.text),this.$router.push({name:"OptionVoters",params:{pollId:this.pollId,optionValue:t.value}})}}},J=D,H=(n("0e96"),Object(r["a"])(J,F,N,!1,null,"c85caa60",null)),B=H.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[t.option?n("h1",{staticClass:"title"},[t._v(t._s(t.voters.length)+' คน โหวตให้ "'+t._s(t.option.text)+'"')]):t._e(),n("table",[n("tbody",t._l(t.voters,(function(e){return n("tr",{key:e.userId},[n("figure",{staticClass:"image is-64x64"},[n("img",{staticClass:"is-rounded",attrs:{src:e.pictureUrl}})]),n("p",{staticClass:"voter-name"},[t._v(t._s(e.displayName))])])})),0)])])])},q=[],R=n("dc59"),K={data:function(){return{pollId:this.$route.params.pollId,optionValue:this.$route.params.optionValue,option:null,voters:[]}},mounted:function(){var t=this;R.pollsCollection.doc(t.pollId).onSnapshot((function(e){console.log("Received doc snapshot: ".concat(JSON.stringify(e.data())));var n=e.data(),o=n.options.findIndex((function(e){return e.value===t.optionValue}));if(o>=0){var i=n.options[o];t.option=i,t.voters=n.voters.filter((function(e){return e.option===t.optionValue}))}}),(function(t){console.log("Encountered error: ".concat(t))}))}},Q=K,X=(n("3ed5"),Object(r["a"])(Q,W,q,!1,null,"e88257da",null)),Y=X.exports;o["a"].use(d["a"]);var G=[{path:"/",name:"Home",component:m},{path:"/products",name:"PizzaList",component:w},{path:"/create-poll",name:"CreatePoll",component:E},{path:"/poll/:id",name:"Poll",component:B},{path:"/poll/:pollId/option/:optionValue",name:"OptionVoters",component:Y},{path:"/poll",redirect:function(t){var e=t.query["liff.state"];return e||"/create-poll"}}],Z=new d["a"]({mode:"history",base:"/",routes:G}),tt=Z,et=n("289d");n("2d94");o["a"].prototype.$liff=window.liff,o["a"].config.productionTip=!1,o["a"].use(et["a"]),new o["a"]({router:tt,render:function(t){return t(u)}}).$mount("#app")},"85ec":function(t,e,n){},c492:function(t,e,n){},c710:function(t,e,n){"use strict";var o=n("2d23"),i=n.n(o);i.a},dc59:function(t,e,n){"use strict";n.r(e),n.d(e,"db",(function(){return l})),n.d(e,"pizzasCollection",(function(){return r})),n.d(e,"pollsCollection",(function(){return c}));var o=n("59ca"),i=n.n(o),s=(n("e71f"),n("dfdd")),a=n.n(s);i.a.initializeApp(a.a);var l=i.a.firestore(),r=l.collection("pizzas"),c=l.collection("polls")},dfdd:function(t,e){t.exports={apiKey:"AIzaSyCq_MJ1_anAG4DagrCIGDtq5ugcqIZ3hfU",authDomain:"pizzanulok-bd80a.firebaseapp.com",databaseURL:"https://pizzanulok-bd80a.firebaseio.com",projectId:"pizzanulok-bd80a",storageBucket:"pizzanulok-bd80a.appspot.com",messagingSenderId:"557513795506",appId:"1:557513795506:web:9329d155da405c0e5e66ab"}}});
//# sourceMappingURL=app.eb27e3c0.js.map